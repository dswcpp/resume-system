# 描述一次你解决复杂技术问题的经历

## 回答框架

用完整 STAR 结构讲述，重点展示：(1) 问题的严重性和复杂度；(2) 分析定位的方法论（不是靠猜）；(3) 方案选择的推理过程；(4) 量化的结果；(5) 从中学到什么。

## 我的实战经历

**公司/项目：** 南京华乘电气 · T95 带电检测手持终端

### 完整故事（2-3 分钟版本）

**情境（S）：**
去年 T95 上线后，现场工程师频繁反馈 UHF 超高频检测模式下界面严重卡顿，波形图掉帧甚至假死 1-2 秒。电力检测需要实时观察波形变化来判断设备是否有故障，卡顿直接影响检测准确性。客户已经开始抱怨了，这是上线后的最高优先级问题。

**任务（T）：**
领导把这个问题交给我，要求定位根因、提出方案、实施优化，同时不能影响数据采集的完整性。难点在于系统已经在产环境运行，多个检测模块同时工作，不能停机大改。

**行动（A）：**

第一步是**数据驱动定位**，不靠猜测。用 Qt Profiler 做性能分析，发现最大异常：锁等待时间占 CPU 的 20% 以上。原来采集线程（1000Hz）和 UI 线程用 QMutex 同步，UHF 模式下每秒 2000 次锁操作，竞争非常严重。

第二步是**方案选型**。分析后发现是典型的 SPSC 场景——一个采集线程写、一个 UI 线程读。查阅资料后选择 SPSC 无锁队列：环形缓冲区 + atomic 索引 + memory_order 保证线程安全。同时加了控频刷新（30Hz 定时拉取）和 shared_ptr 零拷贝。

第三步是**分阶段上线**。先替换 UHF 模块验证一周，确认效果后推广到其他模块，最后删除旧代码。每个阶段都有明确的性能数据对比。

**结果（R）：**

| 指标 | 优化前 | 优化后 |
|------|--------|--------|
| UI 刷新延迟 | 200ms | 50ms |
| CPU 占用 | 85% | 45% |
| 帧率 | 不稳定 | 稳定 30fps |
| 用户反馈 | "经常卡死" | "很丝滑" |

### 从中学到的

1. **性能问题用数据说话**——Profiler 直接指出了锁竞争是瓶颈，如果靠猜可能花几周走弯路
2. **方案匹配场景**——SPSC 比 MPMC 简单得多但恰好够用，不要过度设计
3. **线上改动小步快跑**——分模块上线、可回滚、有对比数据，降低风险
4. **无锁编程不是银弹**——只适合特定场景（SPSC），通用场景还是用 mutex 更安全

## 延伸思考

### 如果面试官问"还有其他复杂问题吗"

**备选故事一：通信优化 100ms→60ms**
思行达柜外终端刷卡慢，分段埋点定位到 JSON 序列化和 TCP 连接是瓶颈，改二进制协议 + 共享内存 + 异步化。

**备选故事二：交叉编译环境搭建**
从零搭建 RK3399 交叉编译环境，踩了 glibc 版本不匹配、符号链接失效、第三方库移植等坑。

### 解决问题的方法论总结

1. 明确问题定义：复述现象与期望结果
2. 快速复现：最小化复现场景
3. 分层定位：用工具测量，不靠猜
4. 数据驱动验证：对比方案的量化指标
5. 最小可行修复：先解决核心瓶颈
6. 沉淀输出：复盘文档、知识库、最佳实践

## 面试表达建议

**时间控制**：2-3 分钟讲完核心故事，不超过 5 分钟。面试官感兴趣会追问。

**开头制造紧迫感**："客户已经在抱怨了，这是上线后最高优先级问题。"

**展示分析过程**：不要直接说"我用了无锁队列"，要先讲"我怎么发现锁竞争是瓶颈的"——这展示的是解决问题的能力，而不仅仅是技术知识。

**承认困难**：不要说得太轻松，"系统已在线上，不能停机大改"——这让故事更有可信度。

**用数字收尾**："200ms 降到 50ms，CPU 从 85% 降到 45%"——数字比形容词有力。
