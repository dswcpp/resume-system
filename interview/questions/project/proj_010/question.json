{
  "id": "proj_010",
  "question": "设备连接状态机怎么设计的？四个状态怎么转换？",
  "tags": [
    "状态机",
    "设备管理",
    "异常恢复"
  ],
  "difficulty": 2,
  "hint": "画出状态转换图：断开→连接中→已连接→异常",
  "answer": "**四状态设计：**\n```\n  ┌─────────┐    connect()    ┌──────────┐\n  │ Disconnected │────────────→│ Connecting  │\n  └─────────┘               └──────────┘\n       ↑                          │\n       │ disconnect()             │ 连接成功\n       │                          ↓\n  ┌─────────┐    超时/异常     ┌──────────┐\n  │  Error     │←───────────│ Connected   │\n  └─────────┘               └──────────┘\n       │                          ↑\n       └──── 自动重连(指数退避) ────┘\n```\n\n**状态转换规则：**\n- **Disconnected → Connecting**：用户或系统触发连接\n- **Connecting → Connected**：握手成功，开始数据通信\n- **Connecting → Error**：连接超时\n- **Connected → Error**：心跳超时、通信异常\n- **Error → Connecting**：自动重连（间隔指数递增：1s→2s→4s→8s，上限30s）\n- **Error → Disconnected**：重连次数超限或用户手动断开\n\n**实现要点：**\n- 每个状态对应一个处理函数，状态转换通过事件触发\n- 心跳机制：每3秒发一次心跳包，连续3次无响应判定为异常\n- **指数退避**重连避免频繁重试浪费资源",
  "source": "简历：四状态状态机、指数退避重连、心跳超时检测"
}