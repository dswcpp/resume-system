{
  "id": "cpp_015",
  "question": "什么是ABA问题？无锁编程中如何应对？",
  "tags": ["ABA问题", "无锁编程", "CAS", "多线程"],
  "difficulty": 3,
  "hint": "CAS操作中值A→B→A",
  "answer": "ABA问题发生在CAS操作中：线程1读到值A被挂起；线程2将A改为B再改回A；线程1恢复后CAS比较仍然成功(值还是A)，但中间状态已经变化，可能导致逻辑错误。解决方案：带版本号的CAS(值和版本号打包，每次修改版本号+1)；单调递增索引(如SPSC队列)天然避免ABA；风险指针(Hazard Pointer)防止节点被回收后重用；RCU延迟回收。SPSC队列因为索引只增不减且不使用CAS，不受ABA影响。",
  "source": "深度问题_无锁队列.md"
}